extends ../../../main
include ../../../inc/mixin

block append js
    if mob

    else
        script(src='#{libPath}router.js')

block ctn
    mixin thumbnail(opt,name)
        if !name
            -name='logo'

        div&attributes(attributes)
            .thumbnail: != f.imgItem(opt, c, name)
            //.caption
            //    h4=opt.title
            if block
                block

    //mixin panel(title,tagCls,more)
    //    if !tagCls
    //        -tagCls='panel-body'
    //    if !attributes.class
    //        -attributes.class='panel panel-default'
    //    div&attributes(attributes)
    //        .panel-heading
    //            h3.panel-title= title
    //            if more
    //                a.pull-right(href=more,style='margin-top:-14px') 查看更多
    //        div(class=tagCls)
    //            if block
    //                block

    //mixin media(posts,opt)
    //    if !opt.ttLimits
    //        -opt.ttLimits= 12
    //    if !opt.ctLimit
    //        -opt.ctLimit= 24
    //    if !opt.singleR
    //        -opt.singleR= false
    //    each it in posts
    //        a.media.media_left.clearfix(href='/#{it._e}/#{it._id}',target='_blank')
    //            if !opt.singleR
    //                .col-xs-4
    //                    != f.imgItem(it, c, opt.func || 'head', 'media-object')
    //            else
    //                != f.imgItem(it, c, opt.func || 'head', 'media-object')
    //            .col-xs-8.body
    //                h4.media-heading!=it.title || it.username
    //                != f.dStr(it.description || it.address, 20)

    body(data-wid= wt.appId, data-wcode= wt.code)
        if !mob
            .container.topLogo
                #header
                    .row
                        .col-md-7.logo
                            h1
                                a(href='/'): img.img-responsive(src='#{resPath}images/logo_03.png', alt='')
                            p 聆听在线-最好用的听力健康平台
                        .col-md-5
                            ul#topBar.list-inline.pull-right
                            .block-search-hder
                                input#q.form-control(name='q', type='text', placeholder='站内搜索')
                                .btn-search

            .navbar.navbar-default
                .container
                    .navbar-header
                        +mobBtn('#navBox')
                        .searchBox
                            a.btn.btn-danger.showBtn
                                != f.icon('search')
                                | 听力搜索专家
                            #searchPanel.list-group.l-search
                                h3.list-group-item 助听器行业搜索神器
                                a.list-group-item(stag="#sProduct" )
                                    != f.icon('th')
                                    | 查找助听器
                                    != f.icon('chevron-right')
                                a.list-group-item(stag="#sConsultant" )
                                    != f.icon('user')
                                    | 查找验配师
                                    != f.icon('chevron-right')
                                a.list-group-item(stag="#sShop" )
                                    != f.icon('home')
                                    | 查找听力中心
                                    != f.icon('chevron-right')
                                a.list-group-item(stag="#sProduct" )
                                    != f.icon('education')
                                    | 查找康复学校
                                    != f.icon('chevron-right')
                                .block-panel-search
                                    #sConsultant
                                    #sShop
                                    #sProduct
                    #navBox.collapse.navbar-collapse
                        +nav(c.nav)#nav.nav.navbar-nav
        .container
            #content.row
            #static.row(class=index)
                block content
        .container
            #footer.row.mt
                .col-md-7.intro
                    p
                        | 免费咨询电话
                        br
                        | 400-0688-153
                        br
                        a(target='_blank', href='http://www.lingtingonline.com') www.lingtingonline.com
                .col-md-2.attention
                    h5 关于我们
                    ul.l-attention
                        li
                            a 广告服务
                        li
                            a 联系我们
                        li
                            a 免责声明
                .col-md-3.share
                    h5 关注我们
                    ul.l-share
                        li
                            a
                                img.img-responsive(src='#{resPath}images/icon-share_25.png', alt='')
                        li
                            a
                                img.img-responsive(src='#{resPath}images/icon-share_27.png', alt='')
                        li
                            a
                                img.img-responsive(src='#{resPath}images/icon-share_29.png', alt='')

block commonjs
    if mob
        :coffee(bare=true,minify=true)
            ls = $('.l-search')
            bps = $('.block-panel-search')

            $('.searchBox').prepend $('h1 img')
            nav = $('#navBox')
            nav.prepend $('.block-search-hder')
            nav.prepend '<hr/>'
            nav.prepend $('.logo p')

            nav.find('.dropdown-menu').removeClass('dropdown-menu')

            $('.navbar-brand').attr
                'data-toggle': 'collapse'
                'data-target': '#searchPanel'

            ls.find('a').click (e)->
                util.setActive(e)
                cf[$(this).attr('stag').substr(1)]()
                $('.navbar-brand').trigger 'click'
    else
        :coffee(bare=true,minify=true)
            ls = $('.l-search')
            bps = $('.block-panel-search')

            $('.searchBox').hover ->
                if cf._sbTimer
                    clearTimeout cf._sbTimer
                ls.show()
            , ->
                cf._sbTimer = setTimeout ->
                    ls.hide()
                , 1000

            ls.hover ->
                if cf._bpTimer
                    clearTimeout cf._bpTimer
                $(this).find('.block-panel-search').show()
            , ->
                cf._bpTimer = setTimeout =>
                    $(this).find('.block-panel-search').hide()
                , 1000


            ls.find('a').hover (e)->
                util.setActive(e)
                ls.find("#{$(this).attr('stag')}").show().siblings().hide()
            , ->
                log 'left'

